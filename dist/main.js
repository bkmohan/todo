(()=>{"use strict";function e(e){let t;try{t=window[e];const o="__storage_test__";return t.setItem(o,o),t.removeItem(o),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}const t=e=>{switch(e){case"low":return"#42a5f5";case"medium":return"#ff6f00";case"high":return"#d32f2f"}},o={weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},d={weekday:"short",month:"short",day:"numeric"},a={hour:"numeric",minute:"numeric"},n=(e,n)=>{let l=document.createElement("div");l.classList.add("todos");let i=document.createElement("div");i.classList.add("todo-list-header");let r=document.createElement("h2");if(r.classList.add("title"),r.textContent=n,i.appendChild(r),"Today"!=n&&"Inbox"!=n){let e=document.createElement("button");e.classList.add("delete-project"),e.textContent="Delete",i.appendChild(e)}if(l.appendChild(i),0==e.length)return l;for(let i=0;i<e.length;i++){let r=document.createElement("div");r.classList.add("todo"),r.setAttribute("data-id",e[i].id);let s=document.createElement("div");s.classList.add("todo-list");let c=document.createElement("div"),u=document.createElement("input");u.setAttribute("type","checkbox"),u.setAttribute("name","check");let p=document.createElement("p");p.classList.add("todo-title"),p.textContent=e[i].title,c.appendChild(u),c.appendChild(p);let m=document.createElement("div"),y=document.createElement("p");y.classList.add("todo-date");let h=e[i].dueDate.toLocaleDateString("en-US",d);"Today"==n&&(h="Today "+e[i].dueDate.toLocaleTimeString("en-US",a)),y.textContent=h;let E=document.createElement("img");E.classList.add("edit-todo"),E.setAttribute("src","./images/edit.svg"),E.setAttribute("alt","edit-btn");let v=document.createElement("img");v.classList.add("delete-todo"),v.setAttribute("src","./images/delete.svg"),v.setAttribute("alt","delete-btn"),m.appendChild(y),m.appendChild(E),m.appendChild(v),s.appendChild(c),s.appendChild(m);let L=document.createElement("div");L.classList.add("todo-details");let S=document.createElement("div"),g=document.createElement("p");g.innerHTML=`<p><span class="detail-head">Title:</span> ${e[i].title}</p>`;let f=document.createElement("p"),b=e[i].dueDate.toLocaleDateString("en-US",o);f.innerHTML=`<p><span class="detail-head">Due Date:</span> ${b}</p>`;let k=document.createElement("p");k.innerHTML=`<p><span class="detail-head">Priority:</span> ${e[i].priority.toUpperCase()}</p>`,S.appendChild(g),S.appendChild(f),S.appendChild(k);let q=document.createElement("div");q.classList.add("description");let T=document.createElement("p");T.innerHTML='<p><span class="detail-head">Description</span></p>';let j=document.createElement("p");j.textContent=e[i].details,q.appendChild(T),q.appendChild(j),L.appendChild(S),L.appendChild(q),r.appendChild(s),r.appendChild(L),r.style=`\n                        border: 1px solid #f0f0f0;\n                        border-left: 4px solid ${t(e[i].priority)};\n                    `,s.addEventListener("click",(t=>{let o=document.querySelector(`div.todo[data-id="${e[i].id}"] > div.todo-details`);"flex"===o.style.display?o.style.display="none":o.style.display="flex"})),e[i].done&&(u.checked=!0,r.classList.add("finished")),l.appendChild(r)}return l},l=document.querySelector(".content"),i=document.querySelector("#add-project"),r=document.querySelector("#add-todo"),s=document.querySelector(".modal-wrapper"),c=document.querySelector(".modal--new-project"),u=document.querySelector(".modal--add-task"),p=document.querySelector(".custom-projects"),m=document.querySelectorAll(".project-name"),y=document.querySelector("#home"),h=document.querySelector("#menu"),E=document.querySelectorAll(".modal-close"),v=document.querySelectorAll(".modal-x"),L=document.querySelector("#add-new-project"),S=document.querySelector("#add-new-task"),g=document.querySelector("#edit-task-btn");let f=document.querySelector("#project-name"),b=document.querySelector("#body-title"),k=document.querySelector("#body-date"),q=document.querySelector("#body-desc"),T=document.querySelector("#body-project"),j=document.querySelector("#body-priority"),C=new class{randomDate(e,t,o,d){var a=new Date(+e+Math.random()*(t-e)),n=o+Math.random()*(d-o)|0;return a.setHours(n),a}projectsList=["Inbox"];todoList=[];constructor(){if(e("localStorage")&&(localStorage.getItem("todos")&&JSON.parse(localStorage.getItem("todos")).forEach((e=>this.addTodo(e.project,e.title,e.dueDate,e.details,e.priority,e.done))),localStorage.getItem("todoProject"))){let e=JSON.parse(localStorage.getItem("todoProject"));this.projectsList=e}}updateLocalStorageTodos(){e("localStorage")&&localStorage.setItem("todos",JSON.stringify(this.todoList))}updateLocalStorageProjects(){e("localStorage")&&localStorage.setItem("todoProject",JSON.stringify(this.projectsList))}getProjectsList(){return this.projectsList}addNewProject(e){this.projectsList.push(e),this.updateLocalStorageProjects()}deleteProject(e){let t=this.projectsList.indexOf(e);this.projectsList.splice(t,1),this.todoList=this.todoList.filter((t=>t.project!=e)),this.updateLocalStorageProjects(),this.updateLocalStorageTodos()}addTodo(e,t,o,d,a,n){this.todoList.push(this._createTodo(e,t,o,d,a,n)),this.updateLocalStorageTodos()}getTodos(e){return this.todoList.filter((t=>t.project==e))}getTodoById(e){for(let t=0;t<this.todoList.length;t++)if(this.todoList[t].id==e)return this.todoList[t]}updateTodo(e,t){for(let o=0;o<this.todoList.length;o++)if(this.todoList[o].id==e){this.todoList[o].project=t.project,this.todoList[o].title=t.title,this.todoList[o].dueDate=t.dueDate,this.todoList[o].details=t.details,this.todoList[o].priority=t.priority,this.todoList[o].done=t.done,this.updateLocalStorageTodos();break}}updateTaskStatus(e,t){for(let o=0;o<this.todoList.length;o++)if(this.todoList[o].id==e){this.todoList[o].done=t,this.updateLocalStorageTodos();break}}getTodayTodos(){let e=new Date;return this.todoList.filter((t=>e.toDateString()==t.dueDate.toDateString()))}getAllTodos(){return this.todoList}deleteTodo(e){let t=-1;for(let o=0;o<this.todoList.length;o++)if(e==this.todoList[o].id){t=o,this.updateLocalStorageTodos();break}this.todoList.splice(t,1),this.updateLocalStorageTodos()}_createTodo(e,t,o,d,a,n){let l=Math.random().toString(16).slice(2);return"string"==typeof o&&(o=new Date(o)),{id:l,project:e,title:t,dueDate:o,details:d,priority:a,done:n}}},w=(new Date).toISOString(),x=w.lastIndexOf(":");function D(e){let t=document.createElement("li");t.classList.add("project-name"),t.textContent=e,p.appendChild(t),t.addEventListener("click",P)}function A(e){"add-todo"==e.target.id?(document.querySelector("#editTask").style.display="none",document.querySelector("#edit-task-btn").style.display="none",document.querySelector("#newTask").style.display="block",document.querySelector("#add-new-task").style.display="inline-block"):(document.querySelector("#editTask").style.display="block",document.querySelector("#edit-task-btn").style.display="inline-block",document.querySelector("#newTask").style.display="none",document.querySelector("#add-new-task").style.display="none"),s.style.display="block",u.style.display="block",T.innerHTML="",C.getProjectsList().forEach((e=>{let t=document.createElement("option");t.setAttribute("value",e),t.textContent=e,T.appendChild(t)}))}function I(e){s.style.display="none",e.target.parentElement.parentElement.style.display="none";let t=document.querySelectorAll(`.${e.target.parentElement.parentElement.classList[0]} input`),o=document.querySelector(`.${e.target.parentElement.parentElement.classList[0]} textarea`),d=document.querySelectorAll(`.${e.target.parentElement.parentElement.classList[0]} select`);t.forEach((e=>{e.value="",e.style.borderColor="",e.style.boxShadow=""})),o&&(o.value="",o.style.borderColor="",o.style.boxShadow=""),d.forEach((e=>{e.selectedIndex=0})),document.querySelectorAll(`.${e.target.parentElement.parentElement.classList[0]} .invalid-feedback`).forEach((e=>{e.style.display="none"}))}function M(e,t,o){o?(e.style.display="none",t.style.borderColor="#719ECE",t.style.boxShadow="0 0 10px #719ECE"):(e.style.display="block",t.style.borderColor="#dc3545",t.style.boxShadow="0 0 10px #dc3545")}function P(e){O(e.target)}function O(e){let t=e.textContent.trim();document.querySelectorAll(".sidebar .project-name").forEach((e=>{e.classList.remove("active")})),e.classList.add("active"),l.innerHTML="","Today"==t?l.appendChild(n(C.getTodayTodos(t),"Today")):l.appendChild(n(C.getTodos(t),t)),"Today"!=t&&"Inbox"!=t&&document.querySelector(".delete-project").addEventListener("click",N),document.querySelectorAll(".delete-todo").forEach((e=>{e.addEventListener("click",H)})),document.querySelectorAll(".edit-todo").forEach((e=>{e.addEventListener("click",$)})),document.querySelectorAll('input[name="check"]').forEach((e=>{e.addEventListener("change",_)}))}function _(e){let t=e.target.parentElement.parentElement.parentElement.getAttribute("data-id");e.target.checked?(C.updateTaskStatus(t,!0),e.target.parentElement.parentElement.parentElement.classList.add("finished")):(C.updateTaskStatus(t,!1),e.target.parentElement.parentElement.parentElement.classList.remove("finished"))}function H(e){C.deleteTodo(e.target.parentElement.parentElement.parentElement.getAttribute("data-id")),O(document.querySelector(".project-name.active"))}function $(e){let t=e.target.parentElement.parentElement.parentElement.getAttribute("data-id");A(e),function(e){let t=C.getTodoById(e);b.value=t.title,k.value=t.dueDate.toISOString().substring(0,16),q.value=t.details;for(let e=0;e<T.options.length;e++)if(T.options[e].value==t.project){T.options[e].selected=!0;break}for(let e=0;e<j.options.length;e++)if(j.options[e].value==t.priority){j.options[e].selected=!0;break}g.setAttribute("data-id",e)}(t)}function N(e){let t=document.querySelector("h2.title").textContent;C.deleteProject(t),O(document.querySelector(".today")),document.querySelector(".custom-projects").innerHTML="",C.getProjectsList().forEach((e=>D(e)))}k.min=w.slice(0,x),i.addEventListener("click",(e=>{s.style.display="block",c.style.display="block"})),r.addEventListener("click",A),E.forEach((e=>e.addEventListener("click",(e=>{I(e)})))),v.forEach((e=>e.addEventListener("click",(e=>{I(e)})))),f.addEventListener("input",(e=>{let t=document.querySelector("#project-name + div.invalid-feedback");f.validity.valueMissing?M(t,f,!1):M(t,f,!0)})),b.addEventListener("input",(e=>{let t=document.querySelector("#body-title + div.invalid-feedback");b.validity.valueMissing?M(t,b,!1):M(t,b,!0)})),k.addEventListener("input",(e=>{let t=document.querySelector("#body-date + div.invalid-feedback");k.validity.valueMissing?M(t,k,!1):M(t,k,!0)})),q.addEventListener("input",(e=>{let t=document.querySelector("#body-desc + div.invalid-feedback");q.validity.valueMissing?M(t,q,!1):M(t,q,!0)})),L.addEventListener("click",(e=>{f.value?(C.addNewProject(f.value),D(f.value),I(e)):f.dispatchEvent(new Event("input"))})),S.addEventListener("click",(e=>{b.value&&k.value&&q.value?(C.addTodo(T.value,b.value,new Date(k.value),q.value,j.value),I(e),O(document.querySelector(".sidebar .active"))):(b.dispatchEvent(new Event("input")),k.dispatchEvent(new Event("input")),q.dispatchEvent(new Event("input")))})),m.forEach((e=>e.addEventListener("click",P))),g.addEventListener("click",(e=>{if(b.value&&k.value&&q.value){let t={project:T.value,title:b.value,dueDate:new Date(k.value),details:q.value,priority:j.value},o=e.target.getAttribute("data-id");C.updateTodo(o,t),e.target.setAttribute("data-id",""),I(e),O(document.querySelector(".sidebar .active"))}else b.dispatchEvent(new Event("input")),k.dispatchEvent(new Event("input")),q.dispatchEvent(new Event("input"))})),y.addEventListener("click",(e=>{O(document.querySelector(".today"))}));let U=!0;h.addEventListener("click",(e=>{U?(document.querySelector(".sidebar").style.width="0",U=!1):(document.querySelector(".sidebar").style.width="20%",U=!0)})),C.getProjectsList().forEach((e=>{"Inbox"!=e&&D(e)})),O(document.querySelector(".today"))})();